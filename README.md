# MidsummerÂ Drought (MSD) Timing Toolkit  
*A Haarâ€“wavelet approach for rainyâ€‘season onset, retreat, and midsummer break detection*

---

This repository contains Python utilities to diagnose **rainyâ€‘season onset/retreat** and the **MidsummerÂ Drought (MSD)** in tropical precipitation. The method follows **GarcÃ­aâ€‘FrancoÂ (2021)**, who adapted a Haar covariance wavelet transform to isolate coherent shifts in daily rainfall intensity.

---
## ğŸ“ŒÂ Key features

| Feature | Description |
|---------|-------------|
| **Haar covariance transform** | Automated or fixedâ€‘dilation Haar wavelet to highlight stepâ€‘like changes in rainfall. |
| **Rainyâ€‘season timing** | Finds first sustained intensification (**onset**) and decline (**retreat**) from the seasonal transform. |
| **MSD timing** | Detects the dry spell between two seasonal peaks by analysing a shorter window within the rainy period. |
| **Diagnostics table** | For each year the code outputs nine metrics (see below). |

### Diagnostic fields (per year)
1. **Year**  
2. **Onset date** â€” first rainfall intensification  
3. **Retreat date** â€” final decline of rainy season  
4. **MSD onset date** â€” start of midsummer break  
5. **MSD end date** â€” reâ€‘intensification after MSD  
6. **CoefÂ min** â€” minimum wavelet coefficient before MSD  
7. **CoefÂ max** â€” peak coefficient after MSD  
8. **Amplitude** =Â CoefÂ maxÂ âˆ’Â CoefÂ min  
9. **JJAS mean precip** â€” average rainfall between onset and retreat  

Results append to `MSD_obs_table.txt` (CSVâ€‘style).

---
## ğŸ”§Â Quick start

### 1Â Â·Â Install
```bash
pip install numpy pandas xarray matplotlib
```

### 2Â Â·Â Run a simple analysis
```python
import xarray as xr
from msd_wavelet import calc_msd

# daily precipitation (time, lat, lon)
precip_ds = xr.open_dataset("CHIRPS_1981â€‘2020_daily.nc")
precip_da = precip_ds["precip"]

# singleâ€‘year MSD diagnostics
calc_msd(dataset_name="CHIRPS", year=2015, ds=precip_da)
```
The function appends a line to `MSD_obs_table.txt` and returns the same values as a Python list.

### 3Â Â·Â Batch loop example
```python
for yr in range(1981, 2021):
    calc_msd("CHIRPS", yr, precip_da)
```

---
## ğŸ—‚ï¸Â Repository layout
| Path | Purpose |
|------|---------|
| `msd_wavelet.py` | Implementation of `calc_msd()` and lowerâ€‘level Haar utilities. |
| `example_data/` | Placeholder for CHIRPS or other daily precipitation datasets. |
| `example_notebook.ipynb` | Walkâ€‘through of endâ€‘toâ€‘end MSD analysis (optional). |
| `MSD_obs_table.txt` | Diagnostics table generated by the script. |

---
## ğŸ“–Â Reference
> **GarcÃ­aâ€‘Franco,Â J.Â L.** (2021). *A wavelet transform approach to detect the MidsummerÂ Drought onset and retreat.* **International Journal of Climatology**,Â 41(6),Â 3862â€“3875. <https://doi.org/10.1002/joc.7061>

If you use this code in academic work, please cite the paper above and consider referencing this repository (Zenodo DOI forthcoming).

---
## ğŸ“¬Â Contact
Developed by **JorgeÂ LuisÂ GarcÃ­aÂ Franco**  
âœ‰ï¸Â [jgcaspark@ciencias.unam.mx](mailto:jgcaspark@ciencias.unam.mx)


